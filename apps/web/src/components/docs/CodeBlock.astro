---

interface Props {
  code: string;
  lang?: string;
  filename?: string;
  highlights?: number[];
}

const { code, lang = "bash", filename, highlights = [] } = Astro.props;
---

<div class="code-block group relative my-4">
  {/* Header with filename and language */}
  <div
    class="flex items-center justify-between rounded-t-lg bg-slate-800 px-4 py-2 border-b border-slate-700"
  >
    <div class="flex items-center gap-3">
      {/* Terminal dots */}
      <div class="flex gap-1.5">
        <div class="w-3 h-3 rounded-full bg-red-500/80"></div>
        <div class="w-3 h-3 rounded-full bg-yellow-500/80"></div>
        <div class="w-3 h-3 rounded-full bg-green-500/80"></div>
      </div>
      {
        filename && (
          <span class="text-sm text-slate-400 font-mono">{filename}</span>
        )
      }
    </div>
    <div class="flex items-center gap-2">
      <span class="text-xs text-slate-500 uppercase font-medium">{lang}</span>
      <button
        class="copy-button p-1.5 rounded-md text-slate-400 hover:text-white hover:bg-slate-700 transition-all opacity-0 group-hover:opacity-100"
        data-code={code}
        aria-label="Copy code"
      >
        <svg
          class="w-4 h-4 copy-icon"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"
          ></path>
        </svg>
        <svg
          class="w-4 h-4 check-icon hidden"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M5 13l4 4L19 7"></path>
        </svg>
      </button>
    </div>
  </div>

  {/* Code content */}
  <pre
    class="!rounded-t-none !mt-0 !bg-slate-900 !border !border-t-0 !border-slate-800 overflow-x-auto"><code class="text-sm">{code}</code></pre>
</div>

<script>
  document.querySelectorAll(".copy-button").forEach((button) => {
    button.addEventListener("click", async () => {
      const code = button.getAttribute("data-code");
      if (code) {
        await navigator.clipboard.writeText(code);
        const copyIcon = button.querySelector(".copy-icon");
        const checkIcon = button.querySelector(".check-icon");
        copyIcon?.classList.add("hidden");
        checkIcon?.classList.remove("hidden");
        setTimeout(() => {
          copyIcon?.classList.remove("hidden");
          checkIcon?.classList.add("hidden");
        }, 2000);
      }
    });
  });
</script>

<style>
  .code-block pre {
    margin: 0 !important;
  }
</style>
