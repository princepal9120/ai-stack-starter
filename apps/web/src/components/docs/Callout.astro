---
import { Icon } from "astro-icon/components";

interface Props {
  type?: "note" | "tip" | "warning" | "caution" | "important";
  title?: string;
}

const { type = "note", title } = Astro.props;

const config = {
  note: {
    icon: "lucide:info",
    bg: "bg-blue-950/50",
    border: "border-blue-500/30",
    title: "Note",
    titleColor: "text-blue-400",
    iconColor: "text-blue-400",
  },
  tip: {
    icon: "lucide:lightbulb",
    bg: "bg-emerald-950/50",
    border: "border-emerald-500/30",
    title: "Good to know",
    titleColor: "text-emerald-400",
    iconColor: "text-emerald-400",
  },
  warning: {
    icon: "lucide:alert-triangle",
    bg: "bg-amber-950/50",
    border: "border-amber-500/30",
    title: "Warning",
    titleColor: "text-amber-400",
    iconColor: "text-amber-400",
  },
  caution: {
    icon: "lucide:alert-circle",
    bg: "bg-red-950/50",
    border: "border-red-500/30",
    title: "Caution",
    titleColor: "text-red-400",
    iconColor: "text-red-400",
  },
  important: {
    icon: "lucide:star",
    bg: "bg-purple-950/50",
    border: "border-purple-500/30",
    title: "Important",
    titleColor: "text-purple-400",
    iconColor: "text-purple-400",
  },
};

const {
  icon,
  bg,
  border,
  title: defaultTitle,
  titleColor,
  iconColor,
} = config[type];
const displayTitle = title || defaultTitle;
---

<aside class={`callout my-6 rounded-lg ${bg} border ${border} p-4`}>
  <div class="flex gap-3">
    <Icon name={icon} class={`w-5 h-5 shrink-0 mt-0.5 ${iconColor}`} />
    <div class="flex-1 min-w-0">
      {
        displayTitle && (
          <p class={`font-semibold text-sm ${titleColor} mb-1`}>
            {displayTitle}
          </p>
        )
      }
      <div class="text-slate-300 text-sm leading-relaxed [&>p]:m-0">
        <slot />
      </div>
    </div>
  </div>
</aside>

<style>
  .callout :global(p:last-child) {
    margin-bottom: 0;
  }
  .callout :global(a) {
    color: inherit;
    text-decoration: underline;
    text-underline-offset: 2px;
  }
  .callout :global(a:hover) {
    opacity: 0.8;
  }
  .callout :global(code) {
    font-size: 0.875em;
  }
</style>
